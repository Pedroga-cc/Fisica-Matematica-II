\chapter{El Método de Separación de Variables}

Ya observamos que podemos hacer uso del método de la transformada de Fourier para reducir una ecuación diferencial en dos variables diferentes a una EDO en una sola variable. Sin embargo, no siempre será cómodo calcular la transformada de Fourier de una función, por lo que sería agradable tener una forma más general de hacer funcionar esta idea.

Para ello, hacemos uso del \textbf{método de separación de variables}, gracias al cual podemos reducir una EDP lineal de $n$ variables en un conjunto de $n$ EDOs para $n$ funciones auxiliares, cada una asociada a una variable independiente de la EDP. Esto lo podemos hacer al proponer que nuestro sistema puede ser descrito mediante una \emph{solución separable}, que consiste en el producto de todas las funciones auxiliares que encontremos mediante la solución de las EDOs.

Para realizar la separación de las variables, haremos uso de $(n-1)$ \emph{constantes de separación}, las que son escogidas, en primera instancia, de forma arbitraria para luego determinarlas gracias a las condiciones de contorno del sistema.

Finalmente, una vez hallamos las soluciones de cada una de las EDOs y planteamos la solución separable del sistema, consideraremos que la solución más general consiste en la \emph{superposición} o \emph{combinación lineal} de todas las posibles soluciones separables del sistema.

Como ejemplo bastante ilustrativo, durante el capítulo resolveremos la ecuación de Helmholtz en diferentes sistemas coordenados, dando origen a diferentes \emph{funciones especiales}, que serán discutidas en mayor profundidad en los capítulos siguientes.

\section{Resolviendo la ecuación de Helmholtz}

Recordemos que la ecuación de Helmholtz es dada por la expresión
\begin{equation}\label{eq:Helmholtz}
    \nabla^2 \psi + k^2 \psi = 0 \ ,
\end{equation}
donde $k$ es una constante asociada al sistema. Desarrollaremos esta ecuación en los tres sistemas de coordenadas más comunes en física.

\subsection{Coordenadas cartesianas}

En un sistema cartesiano, el operador laplaciano se define simplemente como
\begin{equation}
    \nabla^2 = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2} \ .
\end{equation}

De esta forma, dado que nuestra ecuación posee tres variables independientes, podremos reducirla a un sistema de 3 EDOs en las variables $x$, $y$ y $z$. Antes de realizar este procedimiento, plantearemos una solución de la forma
\begin{equation}\label{eq:ansatz}
    \psi(x,y,z) = X(x)Y(y)Z(z) \ .
\end{equation}

Una duda totalmente razonable es por qué considerar una solución de este estilo. La verdad no hay una respuesta directa a esto, más allá de ``\emph{esperemos que funcione}''. Si no fuera el caso, y nuestro sistema comienza a complicarse, puede que sea una mejor idea utilizar algún método alternativo. Sin embargo, cabe mencionar que si los operadores diferenciales (derivadas $n$-ésimas) son aditivos, es decir, no tenemos combinaciones de las variables, una solución de este estilo suele funcionar.

Evaluando la expresión \eqref{eq:ansatz} en la ecuación \eqref{eq:Helmholtz}, podemos escribirla como
\begin{equation}
    YZ \frac{d^2X}{dx^2} + XZ \frac{d^2 Y}{dy^2} + XY \frac{d^2Z}{dz^2} + k^2 XYZ = 0 \ ,
\end{equation}
donde ahora utilizamos derivadas totales en lugar de parciales, puesto que cada una de las funciones depende únicamente de una variable.

Dividimos ahora por la solución $XYZ$, donde hemos asumido que $\psi(x,y,z) \neq 0$, de modo que, luego de reordenar los términos, la ecuación resulta en
\begin{equation} \label{eq:sep_1}
    \frac{1}{X} \frac{d^2 X}{dx^2} = -k^2 - \frac{1}{Y} \frac{d^2 Y}{dy^2} - \frac{1}{Z} \frac{d^2 Z}{dz^2} \ .
\end{equation}

Hemos llegado al paso en donde se aprecia esta \emph{separación de variables}. Notemos que el lado izquierdo de la ecuación \eqref{eq:sep_1} contiene únicamente términos asociados a la variable $x$, mientras que el lado derecho aún tiene dependencia en $y$ y en $z$. La única posibilidad de que ambos lados sean iguales, dado que dependen de variables distintas, es que ambos son a su vez iguales a una \emph{constante de separación}, que en este caso asumiremos real y llamaremos $\lambda_1$,
\begin{align}
    \frac{1}{X} \frac{d^2 X}{dx^2} = \lambda_1 \ , \\
    -k^2 - \frac{1}{Y} \frac{d^2Y}{dy^2} - \frac{1}{Z} \frac{d^2Z}{dz^2} = \lambda_1 \ . \label{eq:EDO_de_y_z}
\end{align}

Notemos que, reordenando términos en la ecuación \eqref{eq:EDO_de_y_z}, podemos nuevamente separar las variables mediante una constante $\lambda_2$, de modo que hemos \emph{dividido la EDP original, dependiente de tres variables, en un sistema de tres EDOs},
\begin{align}
    \frac{d^2X}{dx^2} - \lambda_1 X & = 0 \ , \label{eq:EDO_de_x}  \\
    \frac{d^2Y}{dy^2} - \lambda_2 Y & = 0 \ , \label{eq:EDO_de_y}  \\
    \frac{d^2Z}{dz^2} + (k^2 + \lambda_1 + \lambda_2) Z & = 0 \ . \label{eq:EDO_de_z} 
\end{align}

Cada una de estas EDOs son resolubles mediante los métodos vistos en su primer curso de ecuaciones diferenciales, y las soluciones dependerán del valor y del signo de las constantes de separación. Analicemos las posibles soluciones de la ecuación \eqref{eq:EDO_de_x}:

\begin{equation}
    X_{\lambda_1}(x) = \left\{
    \begin{array}{cc} 
            c_1 \sinh(\sqrt{\lambda_1} x) + c_2 \cosh(-\sqrt{\lambda_1}x) \ , & \text{si } \lambda_1 > 0 \ , \\
            c_1 + c_2 x \ , & \text{si } \lambda_1 = 0 \ , \\
            c_1 \cos(\sqrt{-\lambda_1}x) + c_2 \sin(\sqrt{-\lambda_1}x) \ , & \text{si } \lambda_1 < 0 \ .
    \end{array}
    \right.
\end{equation}

Aquí es importante no olvidar que tenemos una motivación física para realizar estos cálculos, lo que nos ayudará a determinar el signo de la constante de separación. Para la mayoría de los problemas físicos, la solución para $X(x)$ que tiene sentido es aquella en que $\lambda_1$ es negativo, de modo que la solución es una oscilación en la coordenada $x$. Así mismo, podemos hacer un análisis análogo para cada una de las otras ecuaciones, obteniendo soluciones denotadas por $Y_{\lambda_2}(y)$ y $Z_{\lambda_1 \lambda_2}(z)$, donde es importante indicar el subíndice, ya que esta solución es válida para un valor particular de las constantes de separación.

De esta forma, una solución particular a nuestra EDP es dada por
\begin{equation} \label{eq:sol_particular_cartesianas}
    \psi_{\lambda_1 \lambda_2}(x,y,z) = X_{\lambda_1}(x) Y_{\lambda_2}(y) Z_{\lambda_1 \lambda_2}(z) \ ,
\end{equation}
y la solución general corresponderá a una combinación lineal de la solución \eqref{eq_sol_particular_cartesianas}, correspondiendo a una suma sobre todos los valores posibles de $\lambda_1$ y $\lambda_2$, es decir,
\begin{equation}
    \psi(x,y,z) = \sum_{\lambda_1 \lambda_2} C_{\lambda_1 \lambda_2} \psi_{\lambda_1 \lambda_2}(x,y,z) \ ,
\end{equation}
donde los coeficientes $C_{\lambda_1 \lambda_2}$ serán obtenidos al imponer las condiciones de contorno del problema, que por lo general nos llevará a un conjunto finito de valores para $\lambda_1$ y $\lambda_2$.

\newpage

\subsection{Coordenadas cilíndricas}

En este caso, el laplaciano debe definirse de una forma diferente, dada por
\begin{equation}
    \nabla^2 = \frac{1}{\rho} \frac{\partial}{\partial \rho} \left( \rho \frac{\partial}{\partial \rho} \right) + \frac{1}{\rho^2} \frac{\partial^2}{\partial \phi^2} + \frac{\partial^2}{\partial z^2} \ , 
\end{equation}
de modo que la ecuación de Helmholtz \eqref{eq:Helmholtz} se podrá escribir como
\begin{equation} \label{eq:Helmholtz_cilindrica}
    \frac{1}{\rho} \frac{\partial}{\partial \rho} \left( \rho \frac{\partial \psi}{\partial \rho} \right) + \frac{1}{\rho^2} \frac{\partial^2 \psi}{\partial \phi^2} + \frac{\partial^2 \psi}{\partial z^2} + k^2 \psi = 0 \ .
\end{equation}

Nuevamente plantearemos una solución que sea producto de tres funciones, cada una dependiente de una de las variables del problema, es decir
\begin{equation}
    \psi(\rho, \phi, z) = P(\rho) \Phi(\phi) Z(z) \ ,
\end{equation}
que al sustituirlas en la expresión \eqref{eq:Helmholtz_cilindrica} resultará en
\begin{equation}
    \frac{\Phi Z}{\rho} \frac{d}{d\rho}\left( \rho \frac{dP}{d\rho} \right) + \frac{PZ}{\rho^2} \frac{d^2 \Phi}{d\phi^2} + P\Phi \frac{d^2Z}{dz^2} + k^2 P\Phi Z = 0 \ ,
\end{equation}
y dividiendo por $P\Phi Z$, junto a un reordenamiento de los términos, llegamos a la expresión
\begin{equation}
    \frac{1}{\rho P} \frac{d}{d\rho} \left( \rho \frac{dP}{d\rho} \right) + \frac{1}{\rho^2 \Phi} \frac{d^2\Phi}{d\phi^2} + k^2 = - \frac{1}{Z} \frac{d^2Z}{dz^2} \ .
\end{equation}

Dado que a ambos lados de la ecuación tenemos una dependencia en variables diferentes, ambos lados deben ser igual a una constante para no depender de ellas, la que llamaremos $\lambda_1$, de modo que
\begin{align}
    \frac{1}{Z} \frac{d^2Z}{dz^2} & = - \lambda_1 \ , \\
    \frac{1}{\rho P} \frac{d}{d\rho} \left( \rho \frac{dP}{d\rho} \right) + \frac{1}{\rho^2 \Phi} \frac{d^2 \Phi}{d\phi^2} + k^2 & = \lambda_1 \ . \label{eq:EDO_en_rho_phi}
\end{align}

En este caso, la única solución que da sentido físico a nuestro sistema será la oscilante, donde $\lambda_1 < 0$. Esto ocurre debido a que nuestro sistema debe tener condiciones de borde finitas, lo que no ocurre ni en el caso lineal ni en el caso exponencial, donde $Z(z)  \to \infty$ cuando $z \to \infty$. Por ello, y para evitar escribir raíces en nuestras soluciones, podemos establecer que $\lambda_1 = -\ell^2$, con $\ell$ un valor real positivo. 

Ahora, definiendo un valor auxiliar $n^2 = k^2 + \ell^2$, podemos separar la ecuación \eqref{eq:EDO_en_rho_phi} en una parte que dependa de $\rho$ y una que dependa de $\phi$, de modo que luego de multiplicar por $\rho^2$ y manipular un poco los términos, obtenemos la ecuación
\begin{equation}
    \frac{\rho}{P} \frac{d}{d\rho} \left( \rho \frac{dP}{d\rho} \right) + \rho^2 n^2 = - \frac{1}{\Phi} \frac{d^2 \Phi}{d\phi^2} \ , 
\end{equation}
e introduciendo una constante de separación $\lambda_2$, obtenemos las siguientes expresiones
\begin{align}
    \frac{1}{\Phi} \frac{d^2 \Phi}{d\phi^2} & = - \lambda_2 \ , \\
    \frac{\rho}{P} \frac{d}{d\rho} \left( \rho \frac{dP}{d\rho} \right) + n^2 \rho^2 & = \lambda_2 \ .
\end{align}

Las soluciones físicas para la EDO de $\phi$ deberán ser periódicas, dado que $\Phi(\phi + 2\pi) = \Phi(\phi)$, con lo que necesitamos que $\lambda_2 > 0$, ya que el signo menos produce que el término sea negativo. Llamamos $\lambda_2 = m^2$, donde $m$ es un número entero para satisfacer la condición de periodicidad.

Solo nos queda resolver la ecuación radial, es decir, la EDO
\begin{equation}
    \rho \frac{d}{d\rho} \left( \rho \frac{dP}{d\rho} \right) + (n^2 \rho^2 - m^2)P = 0 \ ,
\end{equation}
ecuación que se conoce como \textbf{ecuación diferencial de Bessel}, cuyas soluciones son las \emph{funciones de Bessel} que estudiaremos más adelante en el curso.

REVISAR EN MÁS DETALLE CÓMO LO HACE EL ALE

\section{Coordenadas esféricas}

En un sistema esférico $(r, \theta,\phi)$ el operador laplaciano se define como
\begin{equation}
    \nabla^2 = \frac{1}{r^2 \sin\theta} \left( \sin\theta \frac{\partial}{\partial r}\left( r^2 \frac{\partial}{\partial r} \right) + \frac{\partial}{\partial \theta} \left( \sin\theta \frac{\partial}{\partial \theta} \right) + \frac{1}{\sin\theta} \frac{\partial^2}{\partial \phi^2} \right) \ ,
\end{equation}
con lo que la ecuación de Helmholtz queda como
\begin{equation} \label{eq:Helmholtz_esferica}
    \nabla^2 = \frac{1}{r^2 \sin\theta} \left( \sin\theta \frac{\partial}{\partial r}\left( r^2 \frac{\partial \psi}{\partial r} \right) + \frac{\partial}{\partial \theta} \left( \sin\theta \frac{\partial \psi}{\partial \theta} \right) + \frac{1}{\sin\theta} \frac{\partial^2 \psi}{\partial \phi^2} \right) + k^2\psi = 0 \ ,
\end{equation}
y planteando un \emph{ansatz} de la forma
\begin{equation}
    \psi(r,\theta, \phi) = R(r) \Theta(\theta) \Phi(\phi) \ ,
\end{equation}
que al ser sustituída en la ecuación \eqref{eq:Helmholtz_esferica} resulta en
\begin{equation}
    \frac{\Theta \Phi}{r^2} \frac{d}{dr}\left( r^2 \frac{dR}{dr} \right) + \frac{R\Phi}{r^2\sin\theta} \frac{d}{d \theta} \left( \sin\theta \frac{d\Theta}{d \theta} \right) + \frac{R\Theta}{r^2\sin^2\theta} \frac{d^2\Phi}{d \phi^2} + k^2 R \Theta \Phi = 0 \ .
\end{equation}

Dividiendo por $R\Theta\Phi$ y reordenando los términos, podemos llegar a la expresión
\begin{equation}
    \frac{1}{\Phi} \frac{d^2\Phi}{d\phi^2} = r^2\sin^2\theta \left[ -\frac{1}{Rr^2} \frac{d}{dr}\left( r^2 \frac{dR}{dr} \right) - \frac{1}{\Theta r^2\sin\theta} \frac{d}{d\Theta} \left( \sin\theta \frac{d\Theta}{d\theta} \right) - k^2 \right] \ .
\end{equation}

En este momento, podemos separar ambos lados de la ecuación al igualarlas a una constante $\lambda_1$, de modo que obtenemos el sistema de ecuaciones
\begin{align}
    \frac{1}{\Phi} \frac{d^2\Phi}{d\phi^2} & = \lambda_1 \\
    r^2\sin^2\theta \left[ -\frac{1}{Rr^2} \frac{d}{dr}\left( r^2 \frac{dR}{dr} \right) - \frac{1}{\Theta r^2\sin\theta} \frac{d}{d\Theta} \left( \sin\theta \frac{d\Theta}{d\theta} \right) - k^2 \right] & = \lambda_1 \ , \label{eq:EDO_theta_phi}
\end{align}
y como en la coordenada azimutal $\phi$ debe cumplirse la condición de periodicidad $\Phi(\phi) = \Phi(\phi + 2\pi)$, entonces $\lambda_1<0$, y lo denotamos por $\lambda_1 = -m^2$, con $m$ un número entero. Luego, reemplazamos este valor en la ecuación \eqref{eq:EDO_theta_phi} para poder separarla. Multiplicando por $r^2$, y manipulando un poco los términos, obtenemos la expresión
\begin{equation}
    \frac{1}{R} \frac{d}{dr}\left( r^2 \frac{dR}{dr} \right) + k^2r^2 = - \frac{1}{\Theta\sin\theta} \frac{d}{d\Theta}\left( \sin\theta \frac{d\Theta}{d\theta}\right) + \frac{m^2}{\sin^2\theta} \ .
\end{equation}

En este caso, vale la pena hacer un análisis en función del valor de $m^2$.