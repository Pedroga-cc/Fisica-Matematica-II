\chapter{El método de series para EDO y el problema de Sturm-Liouville} \label{cap:series-sl}

Hasta ahora, hemos estudiado ecuaciones que al cumplir ciertas propiedades, como tener una forma u otra, sabemos hallar una solución de una forma sencilla, como una ecuación de Euler-Cauchy, una EDO lineal de segundo orden con coeficientes constantes, entre otras. Sin embargo, existen algunas ecuaciones que pese a aparentar ser sencillas, no es posible hallar una solución en términos de funciones conocidas, como es el caso de la \emph{ecuación de Airy}
\begin{equation}
    y'' + xy = 0 \ .
\end{equation}
En estos casos, podemos hacer uso del llamado \emph{método de series de potencias} para obtener una solución que, si bien no tiene una forma compacta, nos permite resolver dichos problemas, y encontrar aproximaciones válidas.

\section{Resolver EDOs por el método de series}

Consideremos una ecuación lineal de segundo orden cuyos coeficientes son polinomios en la variable independiente del problema, de la forma
\begin{equation} \label{eq:EDO_Series}
    \frac{d^2 y}{dx} + P(x) \frac{dy}{dx} + Q(x) y(x) = R(x) \ .
\end{equation}

En general, consideraremos que $P(x)$, $Q(x)$ y $R(x)$ son funciones \emph{analíticas} de $x$ en, al menos, un punto $x=x_0$ a menos que se indique lo contrario.

Antes de discutir la existencia de soluciones para esta ecuación, debemos definir las nociones de punto \emph{ordinario} y de punto \emph{singular}.

\begin{defi}
    Dada una ecuación diferencial de la forma \eqref{eq:EDO_Series}, decimos que un punto $x_0$ es un \textbf{punto ordinario} de la ecuación si las funciones $P(x)$ y $Q(x)$ son \emph{analíticas} en $x=x_0$. En caso de que $P(x)$ o $Q(x)$ diverjan en $x = x_0$, diremos que $x_0$ es un \textbf{punto singular}. 
\end{defi}

\begin{defi}
    Dado un punto singular $x=x_0$ para una EDO de la forma \eqref{eq:EDO_Series}, diremos que $x_0$ es un \textbf{punto singular regular} si tanto $(x-x_0)P(x)$ como $(x-x_0)^2Q(x)$ son analíticas en $x=x_0$. En caso contrario, $x_0$ es un \textbf{punto singular irregular, o esencial}.
\end{defi}

En el caso en que el coeficiente $P(x)$ no se anula en el dominio del sistema, podemos garantizar la existencia de una solución para \eqref{eq:EDO_Series} mediante el siguiente teorema
\begin{teorema}[de Fuchs]\label{teo:Fuchs}
    Una ecuación diferencial de la forma \eqref{eq:EDO_Series} posee al menos una solución expresable en una serie de potencias en torno a $x=x_0$ si este es un punto ordinario o un punto singular regular de la EDO \eqref{eq:EDO_Series}. La solución será de la forma 
    \begin{equation} \label{eq:solucion_serie}
        y(x) = \sum_{n=0}^\infty a_n(x-x_0)^{n+s} \ , \qquad a_0 \neq 0
    \end{equation}
    para un número $s$ real y positivo, o bien, de la forma 
    \begin{equation}
        y(x) = y_0 \ln(x-a) + \sum_{n=0}^\infty b_n (x-a)^{n+r} \ , \qquad b_0 \neq 0 
    \end{equation}
    para algún número $r$ real y positivo, donde $y_0$ es una solución de la forma \eqref{eq:solucion_serie}.
\end{teorema}

% \begin{ejemplo}
%     Encuentre una solución en serie de potencias alrededor de $x_0=0$ para la ecuación de Airy
%     \begin{equation*}
%         y''(x) - xy(x) = 0 \ .
%     \end{equation*}

%     Observamos que esta ecuación es de la forma \eqref{eq:EDO_Series}, con $P(x) = 0$, $Q(x) = x$ y $R(x) = 0$. Dado que tanto $P(x)$ como $Q(x)$ son funciones analíticas en todo el intervalo real, de acuerdo con el Teorema de Fuchs, la ecuación de Airy tendrá una solución de la forma
%     \begin{equation}
%         y(x) = \sum_{n=0}^\infty a_n x^{n+s} \ .
%     \end{equation}
% \end{ejemplo}

\section{El problema de Sturm-Liouville}

Para el caso de una EDO de segundo orden, lineal (no hay combinación de derivadas en un mismo término) y homogénea (igualable a 0) de la forma
\begin{equation} \label{eq:Sturm-Liouville}
    \frac{d}{dx}\left[ p(x) \frac{dy}{dx} \right] + q(x) y + \lambda r(x)y = 0 \ , \quad a \leq x \leq b
\end{equation}
donde $p(x)$, $p'(x)$, $q(x)$ y $r(x)$ son funciones reales y continuas en el intervalo $[a,b]$ y $\lambda$ es un parámetro a determinar se conoce como una \textbf{ecuación de Sturm-Liouville}. Cabe mencionar que, desde una perspectiva matemáticamente formal, deben también satisfacerse que tanto $p(x)$ como $r(x)$ son funciones definidas positivas en $[a,b]$. A la función $r(x)$ se le denomina \emph{función peso}.

Si revisamos el capítulo anterior, podemos darnos cuenta que todas las EDO que surgen de separar la ecuación de Helmholtz en diferentes sistemas coordenados corresponden a ecuaciones de Sturm-Liouville, donde ya hemos definido diferentes constantes de separación, salvo $\lambda$.

¿Por qué nos interesa esto? Recordamos que un \emph{operador diferencial} es un operador lineal, es decir, puede actuar sobre un elemento de un espacio vectorial (en este caso, una función) y transformarlo en otro elemento del mismo espacio vectorial. Gracias a ello, podemos definir el \emph{operador de Sturm-Liouville} como
\begin{equation}
    \mathcal{L} = \frac{d}{dx}\left[p(x) \frac{d}{dx}\right] - q(x) \ ,
\end{equation}
de modo que podemos escribir la ecuación de Sturm-Liouville como
\begin{equation}
    \mathcal{L}y = -\lambda r(x) y \ ,
\end{equation}
que corresponde a la expresión de un problema de autovalores, como los vistos en Álgebra Lineal. Por ende, nos interesaría poder determinar el valor de $\lambda$ a partir de la teoría de operadores, pero esta perspectiva escapa a los objetivos del curso. Sin embargo, podrán encontrar en el apéndice X un desarrollo siguiendo este camino.

La perspectiva que sí nos interesa analizar en este curso, es uno de los resultados de entender la ecuación de Sturm-Liouville como un problema de autovalores: la \textbf{ortogonalidad} de sus autofunciones. Si recordamos, una propiedad de los autovectores de un operador es que, cuando están asociados a diferentes autovalores, ellos son ortogonales entre sí. Una \emph{autofunción} es el equivalente a un autovector en el espacio de funciones, de modo que, usando un producto interno apropiado, las funciones asociadas a dos autovalores $\lambda_m$ y $\lambda_n$, denotadas como $y_m$ e $y_n$ respectivamente, satisfacen la relación
\begin{equation}
    \int_a^b w(x) y_m(x) y_n(x) = 0 \ , \quad n \neq m \ .
\end{equation}

En el caso del problema de Sturm-Liouville, la función peso que definimos en el producto interno corresponde a la función peso $r(x)$ del problema, de modo que sus soluciones deberán satisfacer
\begin{equation}
    \int_a^b r(x) y_m(x) y_n(x) = 0 \ , \quad n \neq m \ .
\end{equation}

También es posible mostrar que los autovalores de esta ecuación siempre serán valores reales, demostración que se encuentra en el apéndice X.

\section{Condiciones de contorno de Sturm-Liouville}

Sea un conjunto de condiciones de contorno \emph{homogéneas} (es decir, si tengo un conjunto de funciones $f_i$ que satisfacen la condición de contorno, cualquier combinación lineal de ellas también la satisface) en $x=a$ y en $x=b$. Si para dos funciones cualesquiera, $f(x)$ y $g(x)$, que satisfacen estas condiciones de contorno se verifica que
\begin{equation} \label{eq:SM-condicion}
    p(x)  \left.  \left[ f^\ast(x) \frac{dg}{dx} - g(x)\frac{df^\ast}{dx} \right]\right|_a^b = 0 \ ,
\end{equation}
entonces dichas condiciones de contorno se denominan \textbf{condiciones de contorno de Sturm-Liouville}, las que pueden clasificarse en tres clases, que discutiremos a continuación.

\subsection{Condiciones de contorno periódicas}

En este caso, nos referimos a condiciones de contorno de la forma
\begin{equation}
    \begin{dcases}
        y(a) = y(b) \ , \\
        y'(a) = y'(b) \ ,
    \end{dcases}
\end{equation}
donde además se verifica que $p(a) = p(b)$. En particular, esta última condición es necesaria para que se satisfaga \eqref{eq:SM-condicion}.

\subsection{Condiciones de contorno de tipo Robin, o regulares}

Estas condiciones son de la forma
\begin{equation}
    \begin{dcases}
        \alpha_1 y(a) + \alpha_2 y'(a) = 0 \ , \quad \alpha_1, \alpha_2 \in \mathbb{R} \ , \\
        \beta_1 y(b) + \beta_2 y'(b) = 0 \ , \quad \beta_1, \beta_2 \in \mathbb{R} \ , 
    \end{dcases}
\end{equation}
donde $\alpha_1$ y $\alpha_2$ no son iguales a cero simultáneamente, ni tampoco lo son $\beta_1$ y $\beta_2$.

Este caso corresponde a una generalización (más precisamente, una combinación lineal) de las condiciones de Dirichlet y de Neumann. En efecto, observamos que cuando $\alpha_2 = \beta_2 = 0$, recuperamos las condiciones de Dirichlet, $y(a) = y(b) = 0$; mientras que al hacer $\alpha_1 = \beta_1 = 0$, recuperamos las condiciones de Neumann, $y'(a) = y'(b) = 0$.

Se puede comprobar que estas condiciones satisfacen la ecuación \eqref{eq:SM-condicion} tomando complejo conjugado en la primera ecuación del sistema, y observando que se puede interpretar como un sistema de ecuaciones de dos incógnitas, es decir,
\begin{equation}
    \begin{pmatrix}
        f^\ast(a) & {f^\ast}'(a) \\ g(a) & g'(a)
    \end{pmatrix}
    \begin{pmatrix}
        \alpha_1 \\ \alpha_2
    \end{pmatrix}
    = 
    \begin{pmatrix}
        0 \\ 0
    \end{pmatrix} \ ,
\end{equation}
donde el sistema tendrá infinitas soluciones, de modo que
\begin{equation}
    \left| \begin{array}{cc}
        f^\ast(a) & {f^\ast}'(a) \\ g(a) & g'(a)
    \end{array}
    \right| = f^\ast(a) g'(a) - g(a) {f^\ast}'(a) = 0 \ .
\end{equation}

Mediante un procedimiento análogo para $b$, tenemos que
\begin{equation}
    f^\ast(b) g'(b) - g(b) {f^\ast}'(b) = 0 \ ,
\end{equation}
de modo que se satisface la expresión \eqref{eq:SM-condicion}.

\subsection{Condiciones de contorno singulares}

Corresponden a aquellas soluciones que no son ni regulares ni periódicas. Muchas veces corresponden a funciones $p(x)$ que se anulan en los contornos, o coeficientes que se vuelven infinitos en uno o ambos contornos.

Como caso ilustrativo, consideremos el caso en que $p(a) = p(b) = 0$. En este caso, diremos que $x=a$ y $x=b$ son \emph{puntos singulares} de la ecuación de Sturm-Liouville, como se observa al escribir la ecuación \eqref{eq:Sturm-Liouville} en la forma
\begin{equation}
    y''(x) + \frac{p'(x)}{p(x)} y'(x) + \frac{q(x)}{p(x)} y(x) + \lambda \frac{r(x)}{p(x)} y(x) = 0 \ .
\end{equation}

De esta forma, deberá cumplirse que, en general, las soluciones también sean singulares en estos puntos.